!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("the-darkest-lib",[],t):"object"==typeof exports?exports["the-darkest-lib"]=t():e["the-darkest-lib"]=t()}(window,function(){return function(e){var t={};function a(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(r,s,function(t){return e[t]}.bind(null,s));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){(function(t){var r={Rooms:a(2),boot:function(){}};e.exports=r,t.TDLib=r}).call(this,a(1))},function(e,t){var a;a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rooms=void 0;var r={Room:a(3)};t.Rooms=r},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Phaser=__webpack_require__(4).ensure("phaser"),Settings=__webpack_require__(5);function scrapeComplexObjKey(e,t,a,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)scrapeComplexObjKey(e[s],t,a,r);else if(null!==e&&"object"===_typeof(e))if(a in e)r(e,t);else for(var i in e)scrapeComplexObjKey(e[i],t,a,r)}function findFileNameFromPath(e){var t=e.lastIndexOf("/")+1,a=e.lastIndexOf(".");return-1===t&&(t=0),-1===a?-1:e.slice(t,a)}var TDLRoom=function(_Phaser$Scene){function TDLRoom(e,t){var a;return _classCallCheck(this,TDLRoom),(a=_possibleConstructorReturn(this,(TDLRoom.__proto__||Object.getPrototypeOf(TDLRoom)).call(this,e))).assets={raw:t,array:[]},a.averageLightsContribute,a.cursors,a.layers,a.map,a.name=a.constructor.name,a.player,a.rooms,a}return _inherits(TDLRoom,_Phaser$Scene),_createClass(TDLRoom,[{key:"preload",value:function(){var e=this;this._scrapeAssets(),this.assets.array.forEach(function(t){"nPath"in t?e.load[t.type](t.key,[t.path,t.nPath]):"bPath"in t?(e.load[t.type](t.key,t.path),e.load[t.type](t.key+"_b",t.bPath)):e.load[t.type](t.key,t.path)}),this.load.image("top-border-mask-camera","assets/Masks/topMaskCamera.png"),this.load.image("bottom-border-mask-camera","assets/Masks/bottomMaskCamera.png"),this.load.image("left-border-mask-camera","assets/Masks/leftMaskCamera.png"),this.load.image("right-border-mask-camera","assets/Masks/rightMaskCamera.png")}},{key:"_scrapeAssets",value:function(){var e=this;for(var t in this.assets.raw)scrapeComplexObjKey(this.assets.raw[t],{type:t},"path",function(t,a){t.type=a.type,t.key=findFileNameFromPath(t.path),e.assets.array.push(t)})}},{key:"create",value:function(e){this.player=e.setName("player"),this.lights.enable(),this._setCameraViewport(),this._createRoom(),this._createSprites(),this._applyBorderMasks(),this.layers.setLayersDepth(),this.cameras.main.setBounds(0,0,this.layers.wallsLayer.width,this.layers.wallsLayer.height),this.cameras.main.startFollow(this.player),this.cameras.main.setRoundPixels(!0),this.physics.world.setBounds(Settings.TILE_SIZE,Settings.TILE_SIZE,this.layers.wallsLayer.width-2*Settings.TILE_SIZE,this.layers.wallsLayer.height-2*Settings.TILE_SIZE)}},{key:"_setCameraViewport",value:function(){"MOBILE"===Settings.DEVICE?(this.cameras.main.setPosition((Settings.ROOM_FRAME_IN_TILES_MOBILE+Settings.INVENTORY_WIDTH_IN_TILES_MOBILE)*Settings.TILE_SIZE,(Settings.ROOM_FRAME_IN_TILES_MOBILE+Settings.INVENTORY_HEIGHT_IN_TILES_MOBILE)*Settings.TILE_SIZE),this.cameras.main.setSize(Settings.SCREEN_PROPS.calculatedWidth-2*(Settings.ROOM_FRAME_IN_TILES_MOBILE+Settings.INVENTORY_WIDTH_IN_TILES_MOBILE)*Settings.TILE_SIZE,Settings.ROOM_HEIGHT_IN_TILE*Settings.TILE_SIZE)):(this.cameras.main.setPosition(Settings.ROOM_FRAME_IN_TILES_DESKTOP*Settings.TILE_SIZE,Settings.ROOM_FRAME_IN_TILES_DESKTOP*Settings.TILE_SIZE),this.cameras.main.setSize(Settings.SCREEN_PROPS.calculatedWidth-2*Settings.ROOM_FRAME_IN_TILES_DESKTOP*Settings.TILE_SIZE,Settings.ROOM_HEIGHT_IN_TILE*Settings.TILE_SIZE))}},{key:"_createRoom",value:function(){this.map=this.make.tilemap({key:findFileNameFromPath(this.assets.raw.tilemapTiledJSON.path),tileWidth:Settings.TILE_SIZE,tileHeight:Settings.TILE_SIZE}),this.layers.backgroundLayer=this.map.createDynamicLayer("backgroundLayer",this.map.addTilesetImage(findFileNameFromPath(this.assets.raw.image.tiles.background.path)),0,0),this.layers.wallsLayer=this.map.createDynamicLayer("wallsLayer",this.map.addTilesetImage(findFileNameFromPath(this.assets.raw.image.tiles.walls.path)),0,0),this.layers.wallsMaskLayer=this.map.createDynamicLayer("wallsMaskLayer",this.map.addTilesetImage(findFileNameFromPath(this.assets.raw.image.tiles.walls.bPath)),0,0)}},{key:"_createSprites",value:function _createSprites(){var _this4=this;this.map.objects.forEach(function(layer){layer.objects.forEach(function(element){_this4[element.name]=eval("new "+element.type+"(this,"+(element.x+element.width/2)+", "+(element.y-element.height/2)+");"),_this4[element.name].setName(element.name)})})}},{key:"_applyBorderMasks",value:function(){this.layers.borderMasksLayer.create(0,0,"top-border-mask-camera").setScrollFactor(0).setOrigin(0,0),this.layers.borderMasksLayer.create(0,0,"left-border-mask-camera").setScrollFactor(0).setOrigin(0,0),this.layers.borderMasksLayer.create(this.cameras.main.width-Settings.TILE_SIZE,0,"right-border-mask-camera").setScrollFactor(0).setOrigin(0,0),this.layers.borderMasksLayer.create(0,this.cameras.main.height-Settings.TILE_SIZE,"bottom-border-mask-camera").setScrollFactor(0).setOrigin(0,0)}},{key:"update",value:function(){this._updateMasksByLightDiffusion(),this.children.list.forEach(function(e){"actions"in e&&e.actions.update()})}},{key:"_updateMasksByLightDiffusion",value:function(){this.averageLightsContribute=this.lightSources.calculateAverageLightsContribute(),this.layers.wallsMaskLayer.setAlpha(1-this.averageLightsContribute)}}]),TDLRoom}(Phaser.Scene);exports.default=TDLRoom,module.exports=exports.default},function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=4},function(e,t){e.exports={TILE_SIZE:48,ROOM_HEIGHT_IN_TILE:6,INVENTORY_WIDTH_IN_TILES_MOBILE:1.25,INVENTORY_WIDTH_IN_TILES_DESKTOP:0,INVENTORY_HEIGHT_IN_TILES_MOBILE:0,INVENTORY_HEIGHT_IN_TILES_DESKTOP:1,ROOM_FRAME_IN_TILES_DESKTOP:.5,ROOM_FRAME_IN_TILES_MOBILE:.25,SCREEN_PROPS:{},DEVICE:""}}])});
//# sourceMappingURL=the-darkest-lib.min.js.map